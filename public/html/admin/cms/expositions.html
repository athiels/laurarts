<ul id="admin-table" class="admin-table grid_12"></ul>
<br class="clear">


<script type="text/javascript">

    addActionSelect("changeLang", [{ value: "nl", text: "Nederlands" }, { value: "fr", text: "Frans" }, { value: "en", text: "Engels" }]);
    addActionButton("create", "Nieuwe beurs");

    function main() {
        getData("/api/exposition", data => { createAdminSection(data) }, err => { addNotification("Fout bij het ophalen van data: " + err, "failed"); });
    }
    main();

    function createAdminSection(data) {
        console.log(data);
        setMainTitle("Beurzen");
        setSubTitle(data.length + " items");

        $("#admin-table").empty();
        var lang = getAdminLang();
        data.forEach(exposition => {
            var html = '<li id="' + exposition._id + '" class="grid_12">';
            html += '<div class="grid_1">';
            if (exposition.avatar) html += '<img class="admin-img sphere" src="/img/uploads/' + getImageFilename(exposition.avatar.thumbnail) + '" alt="' + getAtt(exposition, lang, "name") + '"/>'
            html += '</div>';
            html += '<div class="grid_2">' + getAtt(exposition, lang, "name") + '</div>';
            html += '<div class="grid_2">' + formatDate(exposition.fixed.startdate) + '</div>';
            html += '<div class="grid_2">' + formatDate(exposition.fixed.enddate) + '</div>';
            html += '<div class="grid_2">' + getAtt(exposition, lang, "city") + '</div>';
            html += '<div class="grid_2 ellipsis">' + getAtt(exposition, lang, "info").replaceAll(/<br>/g, " ") + '</div>';
            if (exposition.fixed.show == 'false') html += '<div class="grid_1"><i class="fas fa-eye-slash right"></i></div>';
            html += '</li>';

            $("#admin-table").append(html);
        });
        setMainHeight();
    }

    $(document).on("click", "#admin-table li", function () {
        id = $(this).attr('id');
        location.href = location.href + "/update?id=" + id;
    });

    function create() {
        location.href = location.href + "/create";
    }

    function changeLang() {
        main();
    }

</script>